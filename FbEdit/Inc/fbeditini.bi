Const szSecWin=			!"[Win]\13\10"_
								!"Winpos=0,0,0,850,600,127,0,0,162,221,514,107,10,10,0,180,150,10,10\13\10"_
								!"Colors=16777215,0,8404992,16777215,33587200,0,255,16777215,15393755,15329769,15987699,11184810,0,0,16777215,16777215,16777215,16777215,16777215,0,16777215,0,16777215,0,14024703,0,10485760,16512,16512\13\10"_
								!"ressize=257,170,0,52,100,100\13\10"_
								!"Version=1064\13\10"
Const szSecTheme=			!"[Theme]\13\10"_
								!"Current=8\13\10"_
								!"1=Default,128,128,128,8421440,8388608,128,128,128,128,16777344,536871040,128,128,10485760,10485760,10485760,65535,65535,65535,285147264,276824319,14024703,268435456,276840448,16777215,4227072,10485760,255,15329769,12632256,12632256,12632256,8421504,8404992,8421504,14024703,14024703,14024703,14024703,14024703,8404992,13828050,8404992,14024703,0,14024703,0,4194432,16711680,210\13\10"_
								!"2=Black Night,16744448,16744448,16744448,8421440,16711680,33521664,16744448,16744448,16744448,33521664,553615360,16744448,4227327,16711680,16711680,16711680,65535,65535,65535,285147264,276824319,0,12632256,10485760,16777215,8454143,16777215,255,4868682,15420,3158064,12632256,8421504,8388608,8421504,0,0,0,0,12644592,8388672,14745568,8388608,12644592,0,14024703,0,4194432,16711680,210\13\10"_
								!"3=Soothe,16744576,16744576,16744576,16739583,16744576,16744576,16744576,16744576,16744576,16733097,553604009,16744576,16744576,16744576,16744576,16744576,65535,65535,65535,285147264,276824319,12632256,16711680,33592725,11448063,8388863,4737096,4737096,6160571,12632256,8421504,10485760,65535,4868682,16777215,12632256,12632256,12632256,12632256,0,16777215,16777215,0,12644592,0,14024703,0,4194432,16711680,210\13\10"_
								!"4=Breeze,0,16777216,33488896,16777216,16711680,33488896,16777216,16777216,16777216,16777216,536903680,32768,33258752,25198656,8421440,27262976,8454143,8454143,8454143,285147136,285147136,16777215,0,7303023,16777215,42699659,9718089,16744448,15329769,15393755,15329769,12632256,8421504,10485760,16711680,16777215,16777215,16777215,16777215,16316664,0,16777215,0,16777215,0,14024703,0,4194432,16711680,210\13\10"_
								!"5=BlueFB,16744448,16744448,16744448,8421440,16711680,16744448,16744448,16744448,16744448,33521664,553615360,16744448,4227327,16711680,16711680,16711680,8454143,8454143,8454143,285147136,285147136,16777215,0,10485760,16777215,33587200,0,255,16053503,12058623,3158064,12632256,8421504,8388608,8421504,16777215,16777215,16777215,16777215,12644592,8388672,14745568,8388608,16777215,0,14024703,0,4194432,16711680,210\13\10"_
								!"6=Connexion,0,16777216,20077117,16777216,2641712,19420468,16777216,16777216,16777216,16777216,536903680,2839859,19085417,22244027,5466811,19875931,65535,65535,65535,285147264,276824319,13827839,3032109,35141665,8518654,35075430,16777216,20932945,15329769,12632256,8421504,2112547,2310965,16316664,0,13827839,13827839,13827839,13827839,14155519,0,16777215,0,14286591,1847076,14024703,0,4194432,16711680,255\13\10"_
								!"7=Mr. Houndcat,12632256,31580641,33534128,32238571,16711680,33554176,16830158,28751542,28751542,30264781,549239996,12369084,30527953,25198656,8421440,20988159,65535,65535,65535,285147264,276824319,0,9869003,45594551,0,26561024,11974326,30988504,15329769,2894892,8421504,0,65535,11053224,10461087,0,0,0,0,0,6993407,4802889,45232,0,50372,14024703,0,4194432,16711680,210\13\10"_
								!"8=Visual Studio,8404992,8404992,8404992,8404992,8404992,8404992,8404992,8404992,8404992,8404992,545275904,8404992,8404992,8404992,8404992,8404992,8404992,10485760,8404992,276840448,276840448,16777215,0,8404992,16777215,33587200,0,255,16777215,15393755,15329769,15987699,11184810,0,0,16777215,16777215,16777215,16777215,16777215,0,16777215,0,16777215,0,14024703,0,8404992,128,128\13\10"
Const szSecEdit1=			!"[Edit]\13\10"_
								!"EditFont=-15,0,Courier New\13\10"_
								!"LnrFont=-8,255,Terminal\13\10"_
								!"EditOpt=3,0,0,1,0,1,3,1,0,1,1,1,1,0,0,1,1,1,1,1\13\10"_
								!"CodeFiles=.bas.bi.\13\10"_
								!"CaseConvert=CWPp\13\10"_
								!"CustColors=14024703,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\13\10"_
								!"Colors=8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608,545259520,8388736,8388608,8388608,8388608,8388608,16744576,16711680,8421376,276824064,276824064\13\10"
Const szSecEdit2=			!"C0=\34Date$ Err Pen Play Screen Seek Shell Stack Strig Time$ Timer \34\13\10"_
								!"C1=\34Beep BLoad BSave Call Calls Chain ChDir ChDrive Clear Close Cls Color Com Common Const Data Def DefCur DefDbl DefInt DefLng DefSng DefStr Dim Do Environ Erase Error Event Exit Field Files For Get GoSub GoTo Input IoCtl Key Kill Let Line Locate Lock Loop LPrint LSet MkDir Name Next On Open Option Out Poke PokeByte PokeCurr PokeLong PokeWord Print Put Randomize Read ReDim Rem Reset Restore Resume Return RmDir RSet Run Shared Signal Sleep Sound Static Stop Var \34\13\10"_
								!"C2=\34Abs Asc Atn Bin$ Cast CByt CCur CDbl Chr Chr$ CInt CLng Command$ CompileLine CompileLine$ Cos CSng CsrLin CurDir$ Cvb Cvc Cvd Cvi Cvl Cvs Dir$ Environ$ Eof ErDev ErDev$ Erl Error$ Exp FileAttr Fix Fre FreeFile Hex$ InKey$ Inp Input$ Instr Int IoCtl$ LBound LCase$ Left$ Len Loc Lof Log LPos LTrim$ Mkb$ Mkc$ Mkd$ Mki$ Mkl$ Mks$ Oct$ Peek PeekByte PeekCurr PeekLong PeekWord Pos Right$ Rnd RTrim$ Sadd SetMem Sgn Sin Space$ Spc Sqr Sseg Ssegadd Stick Str Str$ String$ Tab Tan Test TestNot Trim$ UBound UCase$ Val VarPtr VarPtr$ VarSeg \34\13\10"_
								!"C3=\34#define #else #elseif #endif #endmacro #error #if #ifdef #ifndef #inclib #include #libpath #line #macro #pragma #print #undef Access Alias Any Append As Base Basic Binary ByRef ByVal Cdecl DisableBOPT DisableFold DisableIncDec DisablePeriodMsg DisableShifts DisableTest DisableTrim Explicit Fortran Go Is Lib LineNumber List Local Off Offset once Output Pascal Pointer Preserve Random Seg Seg$ Stdcall Step Syscall To Until Using WinCon WinGui \34\13\10"_
								!"C4=\34$Begin $Debug $Dynamic $Finish $Ignore $Inc $Include $LineSize $List $Module $Name $OCode $Option $Page $PageIf $PageSize $Process $Skip $Start $Static $StringPool $SubTitle $Title FALSE NULL TRUE \34\13\10"_
								!"C5=\34And Eqv Imp Mod Not Or Rol Ror Shl Shr Xor \34\13\10"_
								!"C6=\34abs access acos alias allocate append as asc asin asm atan2 atn base beep bin$ binary bit bitreset bitset bload bsave byref byval call callocate cbyte cdbl cdecl chain chdir chr$ cint circle clear clng clngint close cls color command$ common continue cos cshort csign csng csrlin cubyte cuint culngint cunsg curdir cushort cvd cvi cvl cvs data date$ deallocate defbyte defined defshort defubyte defuint defushort dim dir$ do draw dylibfree dylibload dylibsymbol dynamic enum environ environ$ eof eqv erase err error escape exec exepath exit exp explicit export extern \34\13\10"_
								!"C7=\34fix flip for fre freefile get getkey getmouse gosub goto hex$ hibyte hiword iif imp inkey$ inp input input$ instr int is kill lbound lcase lcase$ left left$ len let lib line lobyte loc local locate lock lof log loop loword lset ltrim$ mid mid$ mkd$ mkdir mki$ mkl$ mklongint mks$ mkshort mod multikey name next oct$ on open option out output overload paint palette pascal pcopy peek peeki peeks pmap point poke pokei pokes pos preserve preset private procptr pset public put random randomize read reallocate redim reset restore resume resume return rgb right right$ rmdir rnd rset rtrim$ run \34\13\10"_
								!"C8=\34bin command condbroadcast condcreate conddestroy condsignal condwait date dir hex ltrim mkd mki mkl mks mutexcreate mutexdestroy mutexlock mutexunlock oct rtrim sadd screen screencopy screeninfo screenlock screenptr screenres screenset screenunlock seek setenviron sgn shared shell sin sizeof sleep space space$ spc sqr static stdcall step stop str$ strcat strchr strcmp strcpy string$ strlen strncat strncmp strncpy strptr strrchr strstr swap system tab tan threadcreate threadwait time time$ timer to trim trim$ ubound ucase ucase$ union unlock until using va_arg va_first va_next val val64 valint varptr view wait wend while width window windowtitle with write \34\13\10"_
								!"C9=\34Case Constructor Declare Destructor Else ElseIf End EndIf Function If Namespace Operator Property Scope Select Sub Then Type \34\13\10"_
								!"C10=\34#define #include ACCELERATORS ALT AUTOCHECKBOX AUTORADIOBUTTON BEGIN BITMAP BLOCK CAPTION CLASS COMBOBOX CONTROL CURSOR DIALOGEX DISCARDABLE EDITTEXT END EXSTYLE FALSE FILEOS FILETYPE FILEVERSION FONT GROUPBOX ICON LISTBOX LTEXT MENU MENUITEM NOINVERT NULL POPUP PRODUCTVERSION PUSHBUTTON SEPARATOR SHIFT STRINGTABLE STYLE TRUE VALUE VERSIONINFO VIRTKEY \34\13\10"_
								!"C11=\34__DATE__ __FB_BIGENDIAN__ __FB_DEBUG__ __FB_DOS__ __FB_ERR__ __FB_LANG__ __FB_LINUX__ __FB_MAIN__ __FB_MIN_VERSION__ __FB_MT__ __FB_OPTION_BYVAL__ __FB_OPTION_DYNAMIC__ __FB_OPTION_ESCAPE__ __FB_OPTION_EXPLICIT__ __FB_OPTION_PRIVATE__ __FB_OUT_DLL__ __FB_OUT_EXE__ __FB_OUT_LIB__ __FB_OUT_OBJ__ __FB_SIGNATURE__ __FB_VER_MAJOR__ __FB_VER_MINOR__ __FB_VER_PATCH__ __FB_VERSION__ __FB_WIN32__ __FILE__ __File_Nq__ __FUNCTION__ __Function_Nq__ __LINE__ __PATH__ __TIME__ \34\13\10"_
								!"C12=\34\34\13\10"_
								!"C13=\34\34\13\10"_
								!"C14=\34\34\13\10"_
								!"C15=\34\34\13\10"_
								!"C16=\34\34\13\10"_
								!"C17=\34\34\13\10"_
								!"C18=\34\34\13\10"
Const szSecEdit3=			!"C19=\34adc add addpd addps addsd addss and andnpd andnps andpd andps arpl asm bound bsf bsr bswap bt btc btr bts call cbw cdq clc cld clflush cli clts cmc cmova cmovae cmovb cmovbe cmovc cmove cmovg cmovge cmovl cmovle cmovna cmovnae cmovnb cmovnbe cmovnc cmovne cmovng cmovnge cmovnl cmovnle cmovno cmovnp cmovns cmovnz cmovo cmovp cmovpe cmovpe cmovpo cmovs cmovz cmp cmppd cmpps cmps cmpsb cmpsd cmpss cmpsw cmpxchg cmpxchg8b comisd comiss cpuid cvtdq2pd cvtdq2ps cvtpd2dq cvtpd2pi cvtpd2ps cvtpi2pd cvtpi2ps cvtps2dq cvtps2pd cvtps2pi cvtsd2si cvtsd2ss cvtsi2sd cvtsi2ss cvtss2sd cvtss2si cvttpd2dq cvttpd2pi cvttps2dq cvttps2pi cvttsd2si cvttss2si cwd cwde das dec div divpd divps divss daa emms end enter "
Const szSecEdit4=			!"f2xm1 fabs fadd faddp fbld fbstp fchs fclex fcmovb fcmovbe fcmove fcmovnb fcmovnbe fcmovne fcmovnu fcmovu fcom fcomi fcomip fcomp fcompp fcos fdecstp fdiv fdivp fdivr fdivrp femms ffree fiadd ficom ficomp fidiv fidivr fild fimul fincstp finit fist fistp fisub fisubr fld fld1 fldcw fldenv fldl2e fldl2t fldlg2 fldln2 fldpi fldz fmul fmulp fnclex fninit fnop fnsave fnstcw fnstenv fnstsw fpatan fprem fprem1 fptan frndint frstor fsave fscale fsin fsincos fsqrt fst fstcw fstenv fstp fstsw fsub fsubp fsubr fsubrp ftst fucom fucomi fucomip fucomp fucompp fwait fxam fxch fxrstor fxsave fxtract fyl2x fyl2xp1 hlt idiv imul in inc ins insb insd insw int int3 into invd invlpg iret iretd ja jae jb jbe jc jcxz je jecxz jg jge jl jle jmp jna jnae jnb jnbe jnc jne jng jnge jnl jnle jno jnp jns jnz jo jp jpe jpo js jz lahf lar ldmxcsr lds lea leave les lfence lfs lgdt lgs lidt lldt lmsw lock lods lodsb lodsd lodsw loop loope loopne loopnz loopz lsl lss ltr "
Const szSecEdit5=			!"maskmovdqu maskmovq maxpd maxps maxsd maxss mfence minpd minps minsd minss mov movapd movaps movd movdq2q movdqa movdqu movhlps movhpd movhps movlhps movlpd movlps movmskpd movmskps movntdq movnti movntpd movntps movntq movq movq2dq movs movsb movsd movss movsw movsx movupd movups movzx mul mulpd mulps mulsd mulss neg nop not or orpd orps out outs outsb outsd outsw packssdw packsswb packuswb paddb paddd paddq paddsb paddsw paddusb paddusw paddw pand pandn pause pavgb pavgusb pavgw pcmpeqb pcmpeqd pcmpeqw pcmpgtb pcmpgtd pcmpgtw pextrw pf2id pf2iw pfacc pfadd pfcmpeq pfcmpge pfcmpgt pfmax pfmin pfmul pfnacc pfpnacc pfrcp pfrcpit1 pfrcpit2 pfrsqit1 pfrsqrt pfsub pfsubr pi2fd pi2fw pinsrw pmaddwd pmaxsw pmaxub pminsw pminub pmovmskb pmulhrw pmulhuv pmulhuw pmulhw pmullw pmuludq pop popa popad popf popfd por prefetch prefetchnta prefetcht0 prefetcht1 prefetcht2 prefetchw psadbw pshufd pshufhw pshuflw pshufw pslld psllq psllw psrad psraw psrld psrldq psrlq psrlw "
Const szSecEdit6=			!"psubb psubd psubq psubsb psubsw psubusb psubusw psubw pswapd pswapw punpckhbw punpckhdq punpckhqdq punpckhwd punpcklbw punpckldq punpcklqdq punpcklwd push pusha pushad pushf pushfd pxor rcl rcpps rcpss rcr rdmsr rdpmc rdtsc rep repe repne repnz repz ret rol ror rsm rsqrtps rsqrtss sahf sal sar sbb scas scasb scasd scasw seta setae setb setbe setc sete setg setge setl setle setna setnae setnb setnbe setnc setne setng setnge setnl setnle setno setnp setns setnz seto setp setpe setpo sets setz sfence sgdt shl shld shr shrd shufpd shufps sidt sldt smsw sqrtpd sqrtps sqrtsd sqrtss stc std sti stmxcsr stos stosb stosd stosw str sub subpd subps subsd subss sysenter sysexit test ucomisd ucomiss ud2 unpckhpd unpckhps unpcklpd unpcklps verr verw wait wbinvd wrmsr xadd xchg xlat xlatb xor xorpd xorps aaa aad aam aas \34\13\10"
Const szSecEdit7=			!"C20=\34ah al ax bh bl bp bx byte ch cl cx dh dl dword dx eax ebp ebx ecx edi edx esi esp mm0 mm1 mm2 mm3 mm4 mm5 mm6 mm7 offset ptr qword sp st(0) st(1) st(2) st(3) st(4) st(5) st(6) st(7) word xmm0 xmm1 xmm2 xmm3 xmm4 xmm5 xmm6 xmm7 \34\13\10"_
								!"C21=\34\34\13\10"
Const szSecBlock=			!"[Block]\13\10"_
								!"0=%private %public function $,End Function,,,6\13\10"_
								!"1=%private %public sub $,End Sub,,,6\13\10"_
								!"2=type!as,End Type,,,4\13\10"_
								!"3=union,End Union,,,4\13\10"_
								!"4=namespace $,End Namespace,,,4\13\10"_
								!"5='{,'},,,4\13\10"_
								!"6=/','/,,,36\13\10"_
								!"7=constructor $,End Constructor,,,6\13\10"_
								!"8=destructor $,End Destructor,,,6\13\10"_
								!"9=property $,End Property,,,6\13\10"_
								!"10=enum $,End Enum,,,6\13\10"_
								!"11=#macro $,#EndMacro,,,6\13\10"_
								!"12=select case !end select,End Select,case,,0\13\10"_
								!"13=if $! then,EndIf|End If,elseif,else,0\13\10"_
								!"14=do!loop,Loop,,,0\13\10"_
								!"15=while $ !wend,Wend,,,0\13\10"_
								!"16=for $ !next,Next,,,0\13\10"_
								!"17=operator!type,End Operator,,,6\13\10"_
								!"18=with $,End With,,,0\13\10"_
								!"19=asm,End Asm,,,192\13\10"
Const szSecAutoFormat=	!"[AutoFormat]\13\10"_
								!"0=if $! then,0,0,1\13\10"_
								!"1=endif,0,0,0\13\10"_
								!"2=end if,0,0,0\13\10"_
								!"3=elseif,0,0,1\13\10"_
								!"4=else,0,0,1\13\10"_
								!"5=select case,5,0,1\13\10"_
								!"6=case,5,1,1\13\10"_
								!"7=end select,5,0,0\13\10"_
								!"8=while $ !wend,8,0,1\13\10"_
								!"9=wend,8,0,0\13\10"_
								!"10=do,10,0,1\13\10"_
								!"11=loop,10,0,0\13\10"_
								!"12=for $,12,0,1\13\10"_
								!"13=next,12,0,0\13\10"_
								!"14=type $ !as,14,0,1\13\10"_
								!"15=end type,14,0,0\13\10"_
								!"16=%private %public sub $,16,0,1\13\10"_
								!"17=end sub,16,0,0\13\10"_
								!"18=%private %public function $,18,0,1\13\10"_
								!"19=end function,18,0,0\13\10"_
								!"20=operator,20,0,1\13\10"_
								!"21=end operator,20,0,0\13\10"_
								!"22=namespace $,22,0,1\13\10"_
								!"23=end namespace,22,0,0\13\10"_
								!"24=with $,24,0,1\13\10"_
								!"25=end with,24,0,0\13\10"_
								!"26='{,26,0,1\13\10"_
								!"27='},26,0,0\13\10"_
								!"28=asm,28,0,1\13\10"_
								!"29=end asm,28,0,0\13\10"
Const szSecResource=		!"[Resource]\13\10"_
								!"Export=1,2,0,rsrc.bi\13\10"_
								!"Grid=3,3,1,1,1,32896,0,1,0,0,0,1\13\10"
Const szSecTools=			!"[Tools]\13\10"_
								!"1=&Calculator,calc.exe\13\10"_
								!"2=&Notepad,notepad.exe\13\10"_
								!"3=Paint,mspaint.exe\13\10"_
								!"4=Explore Current Path,$\13\10"_
								!"5=Command prompt,cmd.exe \34/K $C\\fbc.exe -version && title FreeBASIC && path $C;%PATH%\34\13\10"_
								!"6=Compiler Version,cmd.exe \34/k $C\\fbc.exe -version\34\13\10"
Const szSecHelp=			!"[Help]\13\10"_
								!"1=Win32,$H\\WIN32.HLP\13\10"_
								!"2=FreeBASIC,$H\\FB.chm\13\10"_
								!"3=Window styles,$A\\Help\\Windows_styles.chm\13\10"_
								!"4=FbEdit help,$A\\Help\\FbEdit.chm\13\10"_
								!"Path=\\FreeBASIC\\Help\13\10"
Const szSecProject=		!"[Project]\13\10"_
								!"Path=$A\\Projects\13\10"
Const szSecMake=			!"[Make]\13\10"_
								!"fbcPath=\\FreeBASIC\13\10"_
								!"Module=Module Build,fbc -c\13\10"_
								!"Current=3\13\10"_
								!"1=Windows GUI,fbc -s gui\13\10"_
								!"2=Windows GUI (debug),fbc -g -s gui\13\10"_
								!"3=Windows Console,fbc -s console\13\10"_
								!"4=Windows Console (debug),fbc -g -s console\13\10"_
								!"5=Deprecated GUI,fbc -lang deprecated -s gui\13\10"_
								!"6=Deprecated GUI (debug),fbc -lang deprecated -g -s gui\13\10"_
								!"7=Deprecated Console,fbc -lang deprecated -s console\13\10"_
								!"8=Deprecated Console (debug),fbc -lang deprecated -g -s console\13\10"_
								!"9=QB GUI,fbc -lang qb -s gui\13\10"_
								!"10=QB GUI (debug),fbc -lang qb -g -s gui\13\10"_
								!"11=QB Console,fbc -lang qb -s console\13\10"_
								!"12=QB Console (debug),fbc -lang qb -g -s console\13\10"_
								!"13=Windows dll,fbc -s gui -dll -export\13\10"_
								!"14=Library,fbc -lib\13\10"
Const szSecOpen=			!"[Open]\13\10"_
								!"1=.bmp.,mspaint.exe\13\10"_
								!"2=.doc.rtf.,wordpad.exe\13\10"
Const szSecApi=			!"[Api]\13\10"_
								!"Api=fb (FreeBASIC),gdip (Gdi+),ogl (OpenGL),sv (Showvars),win (Windows),wx (wx Widgets)\13\10"_
								!"DefApi=fb (FreeBASIC)\13\10"_
								!"Call=fbCall.api,gdipCall.api,oglCall.api,winCall.api,wxCall.api,svcall.api\13\10"_
								!"Const=fbConst.api,oglConst.api,winConst.api,svConst.api\13\10"_
								!"Struct=fbStruct.api,gdipStruct.api,winStruct.api\13\10"_
								!"Word=fbWord.api,winWord.api\13\10"_
								!"Type=fbType.api,oglType.api,winType.api\13\10"_
								!"Case=fbCase.api\13\10"_
								!"Desc=fbDesc.api,winDesc.api\13\10"_
								!"Msg=winMsg.api\13\10"
Const szSecDebug=			!"[Debug]\13\10"_
								!"Debug=$A\\FBdebugger\\FBdebugger.exe\13\10"
Const szSecTemplate=		!"[Template]\13\10"_
								!"txtfiles=.bas.bi.rc.txt.xml.\13\10"_
								!"binfiles=.bmp.jpg.ico.cur.\13\10"
Const szSecPrinter=		!"[Printer]\13\10"_
								!"Page=21000,29700,1000,1000,1000,1000,66\13\10"
Const szSecLanguage=		!"[Language]\13\10"_
								!"Language=(None)\13\10"
Const szSecSniplet=		!"[Sniplet]\13\10"_
								!"WinPos=10,10,800,600\13\10"
Const szSecToolbar=		!"[Toolbar]\13\10"_
								!"WinPos=10,10,577,475\13\10"
Const szSecFileTab=		!"[FileTabStyler]\13\10"_
								!"Style=1\13\10"_
								!"Fixed=0\13\10"_
								!"ModStyle=2\13\10"
Const szSecShowVars=		!"[ShowVars]\13\10"_
								!"Dock=1,10,10,300,200,0,0,0,2500\13\10"
Const szSecProjectZip=	!"[ProjectZip]\13\10"_
								!"pos=407,384,466,255\13\10"_
								!";Optional. Skip all files in folder \\bak\13\10"_
								!"skip=\\bak\13\10"_
								!";Optional. Folder where to put zip files\13\10"_
								!"folder=C:\\Archive\13\10"_
								!";Optional incluse date=1 or datetime=2\13\10"_
								!"opt=2\13\10"

Sub UpdateSection(ByVal sName As String,ByVal sBlock As String)
	Dim As Integer i,l

	buff=sBlock
	buff=Mid(buff,Len(sName)+4)
	i=1
	While i
		i=InStr(buff,!"\13\10")
		If i Then
			buff=Left(buff,i) & Mid(buff,i+2)
		EndIf
	Wend
	i=0
	l=Len(buff)
	While i<l
		If buff[i]=13 Then
			buff[i]=0
		EndIf
		i+=1
	Wend
	buff[i]=0
	WritePrivateProfileSection(sName,@buff,@ad.IniFile)

End Sub
Sub UpdateColorsTo1065()
	Dim i As Integer
	Dim thm As THEME
	Dim szTheme As ZString*32

	LoadFromIni(StrPtr("Win"),StrPtr("Colors"),"444444444444444444444444444444444",@fbcol,FALSE)
	fbcol.propertiespar=fbcol.codetipback
	fbcol.codetipsel=fbcol.codelisttext
	fbcol.codetipapi=fbcol.codelistback
	fbcol.codetiptext=fbcol.dialogtext
	fbcol.codetipback=fbcol.dialogback
	fbcol.codelisttext=fbcol.tooltext
	fbcol.codelistback=fbcol.toolback
	fbcol.dialogtext=fbcol.racol.oprback
	fbcol.dialogback=fbcol.racol.numback
	fbcol.tooltext=fbcol.racol.strback
	fbcol.toolback=fbcol.racol.cmntback
	fbcol.racol.cmntback=fbcol.racol.bckcol
	fbcol.racol.strback=fbcol.racol.bckcol
	fbcol.racol.numback=fbcol.racol.bckcol
	fbcol.racol.oprback=fbcol.racol.bckcol
	SaveToIni(StrPtr("Win"),StrPtr("Colors"),"444444444444444444444444444444444",@fbcol,FALSE)
	For i=1 To 15
		szTheme=""
		thm.lpszTheme=@szTheme
		LoadFromIni(StrPtr("Theme"),Str(i),"044444444444444444444444444444444444444444444444444",@thm,FALSE)
		If szTheme<>"" Then
			thm.fbc.propertiespar=thm.fbc.codetipback
			thm.fbc.codetipsel=thm.fbc.codelisttext
			thm.fbc.codetipapi=thm.fbc.codelistback
			thm.fbc.codetiptext=thm.fbc.dialogtext
			thm.fbc.codetipback=thm.fbc.dialogback
			thm.fbc.codelisttext=thm.fbc.tooltext
			thm.fbc.codelistback=thm.fbc.toolback
			thm.fbc.dialogtext=thm.fbc.racol.oprback
			thm.fbc.dialogback=thm.fbc.racol.numback
			thm.fbc.tooltext=thm.fbc.racol.strback
			thm.fbc.toolback=thm.fbc.racol.cmntback
			thm.fbc.racol.cmntback=thm.fbc.racol.bckcol
			thm.fbc.racol.strback=thm.fbc.racol.bckcol
			thm.fbc.racol.numback=thm.fbc.racol.bckcol
			thm.fbc.racol.oprback=thm.fbc.racol.bckcol
			SaveToIni(StrPtr("Theme"),Str(i),"044444444444444444444444444444444444444444444444444",@thm,FALSE)
		EndIf
	Next
End Sub

Sub CheckIniFile()
	Dim lret As Integer
	Dim hFile As HANDLE

	lret=GetFileAttributes(@ad.IniFile)
	If lret=INVALID_HANDLE_VALUE Then
		' FbEdit.ini does not exist, create it.
		hFile=CreateFile(@ad.IniFile,GENERIC_WRITE,FILE_SHARE_READ,NULL,CREATE_NEW,FILE_ATTRIBUTE_NORMAL,NULL)
		If hFile<>INVALID_HANDLE_VALUE Then
			buff=szSecWin & szSecTheme & szSecEdit1 & szSecEdit2 & szSecEdit3 & szSecEdit4 & szSecEdit5 & szSecEdit6 & szSecEdit7 & szSecBlock & szSecAutoFormat & szSecResource & szSecTools & szSecHelp & szSecProject & szSecMake & szSecOpen & szSecApi & szSecDebug & szSecTemplate & szSecPrinter & szSecLanguage & szSecSniplet & szSecToolbar & szSecFileTab & szSecShowVars & szSecProjectZip
			WriteFile(hFile,@buff,Len(buff),@lret,NULL)
			CloseHandle(hFile)
			DialogBoxParam(hInstance,Cast(ZString Ptr,IDD_DLGPATHOPTION),NULL,@PathOptDlgProc,0)
		Else
			' Coud not create it.
			End
		EndIf
	Else
		CloseHandle(hFile)
		' FbEdit.ini exist, update it.
		buff=ad.AppPath & "\FbEditOld.ini"
		lret=GetPrivateProfileInt("Win","Version",0,@ad.IniFile)
		If lret<1061 Then
			' Delete old backup
			DeleteFile(@buff)
			MoveFile(@ad.IniFile,@buff)
			CheckIniFile
			MessageBox(NULL,"Your FbEdit.ini file was too old to be updated." & CR & "A backup is saved as FbEditOld.ini","FbEdit",MB_OK Or MB_ICONINFORMATION)
		ElseIf lret<>ad.version Then
			CopyFile(@ad.IniFile,@buff,FALSE)
			If lret<1063 Then
				UpdateSection("Block",szSecBlock)
				UpdateColorsTo1065
			ElseIf lret<1065 Then
				UpdateColorsTo1065
			EndIf
			WritePrivateProfileString("Win","Version",Str(ad.version),@ad.IniFile)
			MessageBox(NULL,"The FbEdit.ini file has been updated." & CR & "A backup is saved as FbEditOld.ini","FbEdit",MB_OK Or MB_ICONINFORMATION)
		ElseIf lret=1065 Then
			' Check if colors are updated
			LoadFromIni(StrPtr("Win"),StrPtr("Colors"),"444444444444444444444444444444444",@fbcol,FALSE)
			If fbcol.codetiptext=0 And fbcol.codetipapi=0 And fbcol.codetipsel=0 And fbcol.propertiespar=0 Then
				CopyFile(@ad.IniFile,@buff,FALSE)
				UpdateColorsTo1065
				MessageBox(NULL,"The FbEdit.ini file has been updated." & CR & "A backup is saved as FbEditOld.ini","FbEdit",MB_OK Or MB_ICONINFORMATION)
			EndIf
		EndIf
	EndIf

End Sub
